set realname="Mateusz ≈Åoskot"
set from="mateusz@loskot.net"
set signature="~/.mutt/signature"
set use_from=yes
set beep=no
set beep_new=no
source ~/.mutt/vombatidae.mutt

#######################################################################
# Reading and editing
set mark_old=no
#set pager_index_lines=12   # Split-screen index/pager preview thing
set pager_stop=yes         # Don't skip to next message at end of message
                           # (avoids accidental setting as being read)
set editor="vim +/^$ ++1"
set edit_headers=yes
set text_flowed=yes

#######################################################################
# Folders and mailboxes
set mbox_type=Maildir
set folder="~/Mail/Gmail"
set spoolfile=+INBOX
set record=+INBOX
set postponed=+Drafts
# Gmail seems no longer listing Trash but Bin
set trash=+Bin
mailboxes =INBOX =Drafts =Bin =All\ Mail =Sent\ Mail =Spam

#######################################################################
# SMTP
source "gpg -dq $HOME/.mutt/config.gpg |"
set smtp_url = "$smtp_url"
set smtp_pass = "$smtp_pass"

#######################################################################
# Cache folders
set header_cache=~/.cache/mutt/headers
set message_cachedir=~/.cache/mutt/messages
set certificate_file=~/.cache/mutt/certificates

#######################################################################
# Sidebar
set sidebar_visible
set sidebar_format = "%B%?F? [%F]?%* %?N?%N/?%S"
set sidebar_width = 25
set mail_check_stats

#######################################################################
# Navigation based on favourite Vim bindings (see vim/.vimrc)
#
bind index,pager g noop
bind generic z noop
bind generic Z noop

bind generic,index,pager \Cf next-page
bind generic,index,pager \Cb previous-page

# '?' is used for search-opposite
bind index,pager \Ch help
bind index,pager / search
bind index,pager ? search-reverse
bind index,pager n search-next
bind index,pager N search-opposite

bind index j limit
bind index k next-entry
bind index l previous-entry
bind index K next-thread
bind index L previous-thread
bind index gg first-entry
bind index G last-entry

bind pager k next-line
bind pager l previous-line
bind pager gg top
bind pager G bottom

#######################################################################
# Sorting and threading
set sort=threads
set sort_aux = reverse-last-date-received
set sort_browser=reverse-date
set sort_re
set strict_threads=yes
unset collapse_unread

bind index <space> collapse-thread
bind index - collapse-thread
bind index _ collapse-all

#######################################################################
# GMail-specific
unset move          # gmail does that
set delete          # don't ask, just do
unset confirmappend # don't ask, just do!
set quit            # don't ask, just do!!

bind editor <space> noop
macro index gi "<change-folder>=INBOX<enter>" "Go to INBOX"
macro index gd "<change-folder>=Drafts<enter>" "Go to drafts"
macro index gb "<change-folder>=Bin<enter>" "Go to bin"
macro index gj "<change-folder>=Spam<enter>" "Go to spam"
macro index ga "<change-folder>=All Mail<enter>" "Go to all mail"
macro index gs "<change-folder>=Sent Mail<enter>" "Go to sent mail"
macro index,pager gf "<change-folder>?" "Open mailbox..."

macro index,pager d "<save-message>=Bin<enter>i" "Move messages to Bin"
macro index,pager u "<save-message>=INBOX<enter>i" "Move messages to INBOX"
macro index,pager a "<save-message>=All Mail<enter>i" "Move messages to archive"
#macro index,pager D "<purge-message>"